# -*- coding: utf-8 -*-
"""predictions.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1DoVo85yC3FtvTZ1PZNGaonM62T9BKSEI
"""

import pandas as pd
import numpy as np
import pickle

data_val = pd.read_csv("../data/production/crimen_val_model.txt", sep="\t")
print(data_val.shape)
data_val.head()

# Cargar el modelo guardado con pickle
with open('../models/random_forest_regressor.pkl', 'rb') as file:
    random_forest_regressor_model = pickle.load(file)

# Usar el modelo cargado
predicciones = random_forest_regressor_model.predict(data_val)
data_val['Crime'] = predicciones

data_val.head()

data_val.to_csv('../data/production/predicciones_crimen.csv', index=False, sep = '|')

